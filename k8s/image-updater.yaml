apiVersion: argocd-image-updater.argoproj.io/v1alpha1
kind: ImageUpdater
metadata:
  name: my-blog-image-updater
  namespace: argocd
spec:
  namespace: argocd
  applicationRefs:
    - namePattern: my-blog-app # Matches the ArgoCD Application name
      images:
        - alias: my-blog
          imageName: ghcr.io/chc3954/my-blog-with-rails
          commonUpdateSettings:
            updateStrategy: latest # Updates to the most recent creation date (newest-build)
            allowTags: regexp:^v[0-9]+$ # Only allow tags starting with 'v' followed by numbers
            pullSecret: pullsecret:argocd/ghcr-secret # Uses the secret in argocd namespace
            forceUpdate: true # Ensure update even if not currently running
  writeBackConfig:
    method: git # Configures write-back to the Git repository
